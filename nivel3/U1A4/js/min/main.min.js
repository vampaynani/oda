(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,a=function(t,e){function a(){this.constructor=t}for(var s in e)i.call(e,s)&&(t[s]=e[s]);return a.prototype=e.prototype,t.prototype=new a,t.__super__=e.prototype,t};t=function(t){function i(){this.finish=e(this.finish,this),this.finishEvaluation=e(this.finishEvaluation,this),this.endGame=e(this.endGame,this),this.evaluateAnswer=e(this.evaluateAnswer,this),this.evaluateTextDrop=e(this.evaluateTextDrop,this),this.evaluateImageDrop=e(this.evaluateImageDrop,this),this.startGame=e(this.startGame,this),this.initEvaluation=e(this.initEvaluation,this),this.setMariposa=e(this.setMariposa,this);var t,a;t=[{id:"head",src:"pleca1.png"},{id:"c1",src:"circle1.png"},{id:"c2",src:"circle2.png"},{id:"repeatbtn",src:"repeat-btn.png"},{id:"playagain",src:"play_again.png"},{id:"startgame",src:"start_game.png"},{id:"flecha1",src:"flecha_1.png"},{id:"flecha2",src:"flecha_2.png"},{id:"flecha3",src:"flecha_3.png"},{id:"flecha4",src:"flecha_4.png"},{id:"flecha5",src:"flecha_5.png"},{id:"error",src:"wrong.png"},{id:"success",src:"correct.png"},{id:"mariposaStart1",src:"image_1_dragble.png"},{id:"mariposaStart2",src:"image_2_dragble.png"},{id:"mariposaStart3",src:"image_3_dragble.png"},{id:"mariposaStart4",src:"image_4_dragble.png"},{id:"mariposaStart5",src:"image_5_dragble.png"},{id:"mariposabtnready",src:"btn_finished.png"},{id:"mariposalabel",src:"caterpillar_label.png"},{id:"mariposastep1",src:"image_1_dropArea.png"},{id:"mariposastep2",src:"image_2_dropArea.png"},{id:"mariposastep3",src:"image_3_dropArea.png"},{id:"mariposastep4",src:"image_4_dropArea.png"},{id:"mariposastep5",src:"image_5_dropArea.png"},{id:"mariposaline1",src:"verso_1_dropArea.png"},{id:"mariposaline2",src:"verso_2_dropArea.png"},{id:"mariposaline3",src:"verso_3_dropArea.png"},{id:"mariposaline4",src:"verso_4_dropArea.png"},{id:"mariposaline5",src:"verso_5_dropArea.png"}],a=[{src:"sounds/good.mp3",id:"good"},{src:"sounds/wrong.mp3",id:"wrong"},{src:"sounds/TU3_U1_A4_instructions.mp3",id:"instructions"},{src:"sounds/TU3_U1_A4_song.mp3",id:"song"}],this.mariposa={drags:[{id:"mariposaStart1"},{id:"mariposaStart2"},{id:"mariposaStart3"},{id:"mariposaStart4"},{id:"mariposaStart5"}],texts:[{t:"Wake up now. I can't believe my eyes! Leaving your cocoon. What a big surprise!",x:98,y:417,w:230},{t:"Then you are a caterpillar, long and green, With one goal in life--to eat, eat, eat!",x:200,y:460,w:240},{t:"Now you are a butterfly with wings so new. Fly far away, up into the blue!",x:134,y:504,w:205},{t:"Build a little house called cocoon.\r\n Sleep a little while. I'll see you very soon!",x:109,y:547,w:225},{t:"Tiny little eggs under a leaf, Oh so difficult for me to see!",x:370,y:547,w:170}]},this.positions={dragsImg:[{x:550,y:506},{x:630,y:506},{x:590,y:438},{x:501,y:438},{x:677,y:438}],steps:[{x:126,y:207},{x:144,y:250},{x:126,y:293},{x:144,y:335},{x:126,y:377}],drops:[{x:482,y:184},{x:565,y:130},{x:656,y:175},{x:622,y:268},{x:517,y:278}],flechas:[{x:478,y:273},{x:511,y:140},{x:652,y:134},{x:727,y:261},{x:595,y:360}],ready:{x:577,y:383},start:{x:284,y:539},score:{x:86,y:191},titulo:{x:150,y:131}},this.answers={mariposa:[{t:"d1",d:"mariposastep1"},{t:"d2",d:"mariposastep2"},{t:"d3",d:"mariposastep3"},{t:"d4",d:"mariposastep4"},{t:"d5",d:"mariposastep5"},{t:"dt5",d:"mariposaline1"},{t:"dt2",d:"mariposaline2"},{t:"dt4",d:"mariposaline3"},{t:"dt1",d:"mariposaline4"},{t:"dt3",d:"mariposaline5"}]},i.__super__.constructor.call(this,null,t,a)}return a(i,t),i.prototype.setStage=function(){return i.__super__.setStage.apply(this,arguments),this.insertBitmap("header","head",stageSize.w/2,0,"tc"),this.insertInstructions("instructions","Read and place the pictures and verses in order, then click on Finished.",40,100),this.insertBitmap("label","mariposalabel",this.positions.titulo.x,this.positions.titulo.y),this.insertText("h2","Caterpillar, catterpillar, up in the tree. Where do you come from? Please tell me.","12px Quicksand","#333",154,150),this.library.h2.lineWidth=250,this.addToMain(new Button("btnready",this.preload.getResult("mariposabtnready"),"ready",this.positions.ready.x,this.positions.ready.y)),this.addToMain(new Score("score",this.preload.getResult("c1"),this.preload.getResult("c2"),20,500,10,0)),this.library.score.txtCount.color="#bfd951",this.library.score.txtTotal.color="#ff9933",this.setMariposa()},i.prototype.setMariposa=function(){var t,e,i,a,s,r,o,n,p,l,h,d;for(a=new createjs.Container,this.current=a.name="mariposa",e=n=1;5>=n;e=n+=1)s=this.createBitmap("mariposastep"+e,"mariposastep"+e,this.positions.drops[e-1].x,this.positions.drops[e-1].y),t=this.createBitmap("flecha"+e,"flecha"+e,this.positions.flechas[e-1].x,this.positions.flechas[e-1].y),i=this.createBitmap("mariposaline"+e,"mariposaline"+e,this.positions.steps[e-1].x,this.positions.steps[e-1].y-25),this.addToLibrary(s,i),a.addChild(s,t,i);for(e=p=1,h=this.mariposa.drags.length;h>=p;e=p+=1)o=this.mariposa.drags[e-1],r=new Draggable("d"+e,this.preload.getResult(o.id),e,this.positions.dragsImg[e-1].x,this.positions.dragsImg[e-1].y),r.scaleX=r.scaleY=.8,this.observer.subscribe("init_mariposa",r.initDragListener),r.addEventListener("drop",this.evaluateImageDrop),a.addChild(r),this.addToLibrary(r);for(e=l=1,d=this.mariposa.texts.length;d>=l;e=l+=1)o=this.mariposa.texts[e-1],r=new DraggableText("dt"+e,o.t,e,o.x,o.y),r.text.font="11px Quicksand",r.text.lineHeight=14,r.text.lineWidth=o.w,r.createHitArea(o.w,r.text.getMeasuredHeight()),this.observer.subscribe("init_mariposa",r.initDragListener),r.addEventListener("drop",this.evaluateTextDrop),a.addChild(r),this.addToLibrary(r);return this.addToMain(a),this.introEvaluation(),this},i.prototype.introEvaluation=function(){return i.__super__.introEvaluation.apply(this,arguments),TweenLite.from(this.library.btnready,.5,{alpha:0,y:this.library.btnready.y-20,ease:Back.easeOut}),TweenLite.from(this.library[this.current],.5,{alpha:0,y:20,ease:Back.easeOut,onComplete:this.playInstructions,onCompleteParams:[this]})},i.prototype.initEvaluation=function(){return i.__super__.initEvaluation.apply(this,arguments),this.startGame()},i.prototype.startGame=function(){return this.observer.notify("init_"+this.current),this.library.btnready.addEventListener("click",this.evaluateAnswer)},i.prototype.evaluateImageDrop=function(t){var e,i,a,s;for(this.answer=t.target,e=!1,a=1;!(e===!0||a>5);)i=this.library[""+this.current+"step"+a],s=i.globalToLocal(this.stage.mouseX,this.stage.mouseY),i.hitTest(s.x,s.y)?(this.answer.putInPlace({x:i.x,y:i.y},1,1,1),e=!0):a++;return e?void 0:this.answer.returnToPlace(1,.8,.8)},i.prototype.evaluateTextDrop=function(t){var e,i,a,s;for(this.answer=t.target,e=!1,a=1;!(e===!0||a>5);)i=this.library[""+this.current+"line"+a],s=i.globalToLocal(this.stage.mouseX,this.stage.mouseY),i.hitTest(s.x,s.y)?"mariposa"===this.current&&(this.answer.putInPlace({x:i.x+40,y:i.y+7},1,this.answer.scaleX,this.answer.scaled),e=!0):a++;return e?void 0:this.answer.returnToPlace(1,this.answer.scaleX,this.answer.scaleY)},i.prototype.evaluateAnswer=function(){var t,e,i,a,s,r,o;for(this.library.btnready.removeEventListener("click",this.evaluateAnswer),this.complete=!0,o=this.answers[this.current],s=0,r=o.length;r>s;s++)a=o[s],e=a.t.length>2?this.library[a.t].localToLocal(5,5,this.library[a.d]):this.library[a.t].localToLocal(20,20,this.library[a.d]),t=this.library[a.d].localToLocal(0,0,this.mainContainer),this.library[a.t].hitTest(e.x,e.y)?(this.library.score.plusOne(),i=this.createBitmap("success","success",t.x,t.y)):(this.complete=!1,i=this.createBitmap("error","error",t.x,t.y)),this.library[this.current].addChild(i);return setTimeout(this.endGame,1e3)},i.prototype.endGame=function(){var t;return this.complete=!1,t=createjs.Sound.play("song"),t.addEventListener("complete",this.finishEvaluation)},i.prototype.finishEvaluation=function(){return TweenLite.to(this.library.label,.5,{alpha:0,y:this.library.label.y-20,ease:Back.easeOut}),TweenLite.to(this.library.h2,.5,{alpha:0,y:this.library.h2.y-20,ease:Back.easeOut}),TweenLite.to(this.library.btnready,.5,{alpha:0,y:this.library.btnready.y-20,ease:Back.easeOut}),TweenLite.to(this.library[this.current],.5,{alpha:0,y:20,ease:Back.easeOut,onComplete:this.finish})},i.prototype.finish=function(){return i.__super__.finish.apply(this,arguments)},window.U1A4=i,i}(Oda)}).call(this);