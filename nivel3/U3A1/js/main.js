// Generated by CoffeeScript 1.6.3
(function() {
  var U3A1,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  U3A1 = (function(_super) {
    __extends(U3A1, _super);

    function U3A1() {
      this.repeatSound = __bind(this.repeatSound, this);
      this.nextEvaluation = __bind(this.nextEvaluation, this);
      this.finishEvaluation = __bind(this.finishEvaluation, this);
      this.evaluateAnswer = __bind(this.evaluateAnswer, this);
      this.evaluateDrop = __bind(this.evaluateDrop, this);
      this.initEvaluation = __bind(this.initEvaluation, this);
      var manifest, sounds;
      manifest = [
        {
          id: 'head',
          src: 'pleca1.png'
        }, {
          id: 'inst',
          src: 'inst.png'
        }, {
          id: 'c1',
          src: 'circle1.png'
        }, {
          id: 'c2',
          src: 'circle2.png'
        }, {
          id: 'repeatbtn',
          src: 'repeat-btn.png'
        }, {
          id: 'playagain',
          src: 'play_again.png'
        }, {
          id: 'startgame',
          src: 'start_game.png'
        }, {
          id: 'btnfinished',
          src: 'btn_finished.png'
        }, {
          id: 'btnrepeat',
          src: 'btn_repeat.png'
        }, {
          id: 'dragbledontlike',
          src: 'dragble_dontlike.png'
        }, {
          id: 'dragblehate',
          src: 'dragble_hate.png'
        }, {
          id: 'dragblelike',
          src: 'dragble_like.png'
        }, {
          id: 'dragblelove',
          src: 'dragble_love.png'
        }, {
          id: 'fondo',
          src: 'fondo.png'
        }, {
          id: 'imgwrong',
          src: 'wrong.png'
        }, {
          id: 'imgcorrect',
          src: 'correct.png'
        }
      ];
      sounds = [
        {
          src: 'sounds/good.mp3',
          id: 'good'
        }, {
          src: 'sounds/wrong.mp3',
          id: 'wrong'
        }, {
          src: 'sounds/TU2_U7_A2_instructions.mp3',
          id: 'instructions'
        }, {
          src: 'sounds/TU2_U7_A2_schedule1.mp3',
          id: 'sche1'
        }, {
          src: 'sounds/TU2_U7_A2_schedule2.mp3',
          id: 'sche2'
        }
      ];
      this.game = {
        gustos: {
          chic1: ['dragblelove', 'dragblelove', 'dragblelove', 'dragblelove', 'dragblelove', 'dragblelove'],
          chic2: ['dragblelove', 'dragblelove', 'dragblelove', 'dragblelove', 'dragblelove', 'dragblelove'],
          chic3: ['dragblelove', 'dragblelove', 'dragblelove', 'dragblelove', 'dragblelove', 'dragblelove'],
          chic4: ['dragblelove', 'dragblelove', 'dragblelove', 'dragblelove', 'dragblelove', 'dragblelove'],
          faces: ['dragblelove', 'dragblelike', 'dragbledontlike', 'dragblehate']
        },
        actividades: {
          boy: ['boypropbaseball', 'boydragbleclean', 'boydragbleread', 'boypropbasketball', 'boyproptennis', 'boydragblecanoeing', 'boypropswimming', 'boydragbleriding', 'boydragblebiking', 'boydragblefishing'],
          boydrags: ['boydragbleclean', 'boydragbleread', 'boydragblecanoeing', 'boydragbleriding', 'boydragblebiking', 'boydragblefishing'],
          girl: ['girldragbleswimming', 'girldragblehiking', 'girldragblesoccer', 'girlpropclean', 'girldragblecanoeing', 'girlpropriding', 'girlproprest', 'girldragblevolleyball', 'girldragblefishing', 'girlproptennis'],
          girldrags: ['girldragbleswimming', 'girldragblehiking', 'girldragblesoccer', 'girldragblecanoeing', 'girldragblevolleyball', 'girldragblefishing']
        }
      };
      U3A1.__super__.constructor.call(this, null, manifest, sounds);
    }

    U3A1.prototype.setStage = function() {
      U3A1.__super__.setStage.apply(this, arguments);
      this.actividades = this.game.gustos;
      this.insertBitmap('header', 'head', stageSize.w / 2, 0, 'tc');
      this.insertInstructions('instructions', 'Listen and drag the icons to the correct place on the schedule.', 40, 100);
      this.insertBitmap('btnRepeat', 'btnrepeat', 480, 540);
      this.insertBitmap('btnFinished', 'btnfinished', 610, 540);
      this.addToMain(new Score('score', this.preload.getResult('c1'), this.preload.getResult('c2'), 20, 500, 24, 0));
      this.insertBitmap('fondo', 'fondo', stageSize.w / 2, 130, 'tc');
      return this.setPizarra(1).introEvaluation();
    };

    U3A1.prototype.setPizarra = function(schedule) {
      var actividades, c, hit, i, _i, _j, _ref;
      this.schedule = schedule;
      this.pizarra = new createjs.Container();
      this.pizarra.name = 'pizarra';
      this.pizarra.x = 0;
      this.pizarra.y = 0;
      actividades = new createjs.Container();
      this.current = actividades.name = "actividades" + schedule;
      actividades.x = 280;
      actividades.y = 223;
      this.addToLibrary(actividades);
      this.drops = "@actividades.chic" + this.schedule;
      this.drags = this.actividades.faces;
      for (i = _i = 0; _i <= 5; i = ++_i) {
        c = new createjs.Container();
        c.name = "cont" + i;
        c.y = i * 49;
        c.x = 0 + ((schedule - 1) * 125);
        hit = new createjs.Shape();
        hit.graphics.beginFill('rgba(0,0,0,1)').drawRect(-25, -25, 90, 45);
        this.setReg(hit, 20, -20);
        c.addChild(hit);
        this.addToLibrary(c);
        actividades.addChild(c);
      }
      this.addToMain(actividades);
      for (i = _j = 0, _ref = this.drags.length - 1; 0 <= _ref ? _j <= _ref : _j >= _ref; i = 0 <= _ref ? ++_j : --_j) {
        c = new Droppable("" + this.drags[i], this.preload.getResult(this.drags[i]), i, 70 * i + 150, 540, this.stage, actividades.children);
        this.addToLibrary(c);
        this.pizarra.addChild(c);
      }
      this.addToMain(this.pizarra);
      return this;
    };

    U3A1.prototype.introEvaluation = function() {
      U3A1.__super__.introEvaluation.apply(this, arguments);
      TweenLite.from(this.library.header, 1, {
        y: -this.library.header.height
      });
      TweenLite.from(this.library.instructions, 1, {
        alpha: 0,
        x: 0,
        delay: 0.5
      });
      TweenLite.from(this.library.btnRepeat, 1, {
        alpha: 0,
        y: this.library.btnRepeat.y - 5,
        delay: 0.5
      });
      TweenLite.from(this.library.btnFinished, 1, {
        alpha: 0,
        y: this.library.btnFinished.y - 5,
        delay: 0.5
      });
      return TweenLite.from(this.library.pizarra, 1, {
        alpha: 0,
        y: this.library.pizarra.y + 20,
        delay: 1,
        onComplete: this.playInstructions,
        onCompleteParams: [this]
      });
    };

    U3A1.prototype.initEvaluation = function(e) {
      var i, _i, _ref;
      U3A1.__super__.initEvaluation.apply(this, arguments);
      for (i = _i = 0, _ref = this.drags.length - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {
        this.library["" + this.drags[i]].initDragListener();
        this.library["" + this.drags[i]].addEventListener('dropped', this.evaluateDrop);
      }
      this.library.btnRepeat.addEventListener('click', this.repeatSound);
      this.library.btnFinished.addEventListener('click', this.evaluateAnswer);
      return createjs.Sound.play("sche" + this.schedule);
    };

    U3A1.prototype.evaluateDrop = function(e) {
      var v;
      this.answer = e.target;
      this.drop = e.drop;
      this.answer.returnToPlace();
      v = this.createBitmap(this.answer.name, this.answer.name, 0, 20);
      v.scaleX = v.scaleY = 0.6;
      this.setReg(v, v.width / 2, v.height / 2);
      return this.drop.addChild(v);
    };

    U3A1.prototype.evaluateAnswer = function(e) {
      var answers, i, res, _i, _ref;
      this.library.btnRepeat.removeEventListener('click', this.repeatSound);
      this.library.btnFinished.removeEventListener('click', this.evaluateAnswer);
      createjs.Sound.stop();
      if (this.schedule === 1) {
        answers = this.actividades.chic1;
      } else if (this.schedule === 2) {
        answers = this.actividades.chic2;
      } else if (this.schedule === 3) {
        answers = this.actividades.chic3;
      } else {
        answers = this.actividades.chic4;
      }
      for (i = _i = 0, _ref = answers.length - 1; _i <= _ref; i = _i += 1) {
        res = this.createSprite('resultado', ['imgwrong', 'imgcorrect'], null, this.library["cont" + i].x + 25, this.library["cont" + i].y);
        res.scaleY = res.scaleX = 0.5;
        if (this.library["cont" + i].children.length > 1) {
          if (this.library["cont" + i].children[1].name === answers[i]) {
            this.library.score.plusOne();
            res.currentFrame = 1;
          } else {
            res.currentFrame = 0;
          }
        }
        this.library[this.current].addChild(res);
      }
      return setTimeout(this.nextEvaluation, 4 * 1000);
    };

    U3A1.prototype.finishEvaluation = function() {
      return TweenLite.to(this.library.pizarra, 1, {
        alpha: 0,
        y: this.library.pizarra.y + 20,
        onComplete: this.nextEvaluation
      });
    };

    U3A1.prototype.nextEvaluation = function() {
      var i, _i, _ref;
      this.index++;
      if (this.index < 4) {
        this.pizarra.removeAllChildren();
        this.setPizarra(this.index + 1);
        for (i = _i = 0, _ref = this.drags.length - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {
          this.library["" + this.drags[i]].initDragListener();
          this.library["" + this.drags[i]].addEventListener('dropped', this.evaluateDrop);
        }
        this.library.btnRepeat.addEventListener('click', this.repeatSound);
        this.library.btnFinished.addEventListener('click', this.evaluateAnswer);
        return createjs.Sound.stop();
      } else {
        return this.finish();
      }
    };

    U3A1.prototype.repeatSound = function() {
      createjs.Sound.stop();
      return createjs.Sound.play("sche" + this.schedule);
    };

    U3A1.prototype.finish = function() {
      TweenLite.to(this.library.pizarra, 1, {
        alpha: 0
      });
      TweenLite.to(this.library.actividades1, 1, {
        alpha: 0
      });
      TweenLite.to(this.library.actividades2, 1, {
        alpha: 0
      });
      TweenLite.to(this.library.actividades3, 1, {
        alpha: 0
      });
      TweenLite.to(this.library.actividades4, 1, {
        alpha: 0
      });
      TweenLite.to(this.library.fondo, 1, {
        alpha: 0
      });
      TweenLite.to(this.library.btnRepeat, 1, {
        alpha: 0,
        y: this.library.btnRepeat.y - 5
      });
      TweenLite.to(this.library.btnFinished, 1, {
        alpha: 0,
        y: this.library.btnFinished.y - 5
      });
      return U3A1.__super__.finish.apply(this, arguments);
    };

    window.U3A1 = U3A1;

    return U3A1;

  })(Oda);

}).call(this);
