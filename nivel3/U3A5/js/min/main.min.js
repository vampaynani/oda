(function(){var t,i=function(t,i){return function(){return t.apply(i,arguments)}},s={}.hasOwnProperty,e=function(t,i){function e(){this.constructor=t}for(var n in i)s.call(i,n)&&(t[n]=i[n]);return e.prototype=i.prototype,t.prototype=new e,t.__super__=i.prototype,t};t=function(t){function s(){this.finish=i(this.finish,this),this.finishEvaluation=i(this.finishEvaluation,this),this.evaluateAnswer=i(this.evaluateAnswer,this),this.initEvaluation=i(this.initEvaluation,this);var t,e;t=[{id:"head",src:"pleca1.png"},{id:"c1",src:"circle1.png"},{id:"c2",src:"circle2.png"},{id:"repeatbtn",src:"repeat-btn.png"},{id:"playagain",src:"play_again.png"},{id:"startgame",src:"start_game.png"},{id:"bg",src:"bg.png"},{id:"1",src:"1.png"},{id:"2",src:"2.png"},{id:"3",src:"3.png"},{id:"4",src:"4.png"},{id:"5",src:"5.png"},{id:"6",src:"6.png"},{id:"1b",src:"1b.png"},{id:"2b",src:"2b.png"},{id:"3b",src:"3b.png"},{id:"4b",src:"4b.png"},{id:"5b",src:"5b.png"},{id:"6b",src:"6b.png"},{id:"1p1",src:"1p1.png"},{id:"1p2",src:"1p2.png"},{id:"4p1",src:"4p1.png"},{id:"4p2",src:"4p2.png"},{id:"5p1",src:"5p1.png"},{id:"5p2",src:"5p2.png"},{id:"6p1",src:"6p1.png"},{id:"6p2",src:"6p2.png"}],e=[{src:"sounds/good.mp3",id:"good"},{src:"sounds/wrong.mp3",id:"wrong"},{src:"sounds/TU3_U3_A5_instructions.mp3",id:"instructions"},{src:"sounds/TU3_U3_A5_scene1.mp3",id:"scene1"}],this.game=[{texts:[{idx:1,t:"trees",x:"701",y:"492",p:"p1"},{idx:1,t:"lake",x:"665",y:"547",p:"p2"},{idx:2,t:"wind",x:"731",y:"532"},{idx:3,t:"animals",x:"557",y:"497"},{idx:4,t:"back",x:"496",y:"484",p:"p1"},{idx:4,t:"backpack",x:"595",y:"542",p:"p2"},{idx:5,t:"sunlight",x:"574",y:"459",p:"p1"},{idx:5,t:"world",x:"659",y:"468",p:"p2"},{idx:6,t:"eyes",x:"518",y:"533",p:"p1"},{idx:6,t:"sky",x:"634",y:"511",p:"p2"}],positions:[{x:64,y:177},{x:64,y:238},{x:64,y:310},{x:412,y:177},{x:412,y:260},{x:412,y:312}]}],this.answers=[],s.__super__.constructor.call(this,null,t,e)}return e(s,t),s.prototype.setStage=function(){return s.__super__.setStage.apply(this,arguments),this.intento=0,this.insertBitmap("bg","bg",0,50),this.insertBitmap("header","head",stageSize.w/2,0,"tc"),this.insertInstructions("instructions","Listen, read and drag the words to complete the text.",40,100),this.addToMain(new Score("score",this.preload.getResult("c1"),this.preload.getResult("c2"),20,500,10,0)),this.library.score.txtCount.color="#BFD951",this.library.score.txtTotal.color="#0096DB",this.setCuento(1).introEvaluation()},s.prototype.setCuento=function(t){var i,s,e,n,r,a,o,p,h;for(i=new createjs.Container,i.name="cuento",this.scene=t,e=a=1,p=this.game[t-1].positions.length;p>=a;e=a+=1)n=2===e||3===e?this.createSprite("sc"+e,[""+(4*(t-1)+e),""+(4*(t-1)+e)+"b"],null,this.game[t-1].positions[e-1].x,this.game[t-1].positions[e-1].y):this.createSprite("sc"+e,[""+(4*(t-1)+e),""+(4*(t-1)+e)+"p1",""+(4*(t-1)+e)+"p2",""+(4*(t-1)+e)+"b"],null,this.game[t-1].positions[e-1].x,this.game[t-1].positions[e-1].y),s=new createjs.Shape,s.graphics.beginFill("rgba(255,255, 255, 0.1)").drawRect(0,0,n.width,n.height),s.name="hsc"+e,s.x=this.game[t-1].positions[e-1].x,s.y=this.game[t-1].positions[e-1].y,i.addChild(s),s.index=4*(t-1)+e,i.addChild(s,n),this.addToLibrary(s,n);for(e=o=1,h=this.game[t-1].texts.length;h>=o;e=o+=1)r=new DraggableText("t"+e,this.game[t-1].texts[e-1].t,this.game[t-1].texts[e-1].idx,this.game[t-1].texts[e-1].x,this.game[t-1].texts[e-1].y),r.text.textAlign="center",r.setHitArea(),this.game[t-1].texts[e-1].p&&(r.p=this.game[t-1].texts[e-1].p),this.addToLibrary(r),i.addChild(r);return this.addToMain(i),this},s.prototype.introEvaluation=function(){var t,i,e;for(s.__super__.introEvaluation.apply(this,arguments),t=i=1,e=this.game[this.scene-1].texts.length;e>=i;t=i+=1)this.observer.subscribe("init_evaluation",this.library["t"+t].onInitEvaluation);return TweenLite.from(this.library.header,1,{y:-this.library.header.height}),TweenLite.from(this.library.instructions,1,{alpha:0,x:0,delay:.5}),TweenLite.from(this.library.cuento,1,{alpha:0,y:this.library.cuento.y+20,delay:1,onComplete:this.playInstructions,onCompleteParams:[this]})},s.prototype.initEvaluation=function(){var t,i,e,n;for(s.__super__.initEvaluation.apply(this,arguments),createjs.Sound.play("scene"+this.scene),n=[],t=i=1,e=this.game[this.scene-1].texts.length;e>=i;t=i+=1)n.push(this.library["t"+t].addEventListener("click",this.evaluateAnswer));return n},s.prototype.evaluateAnswer=function(t){var i,s,e,n,r,a,o;for(this.answer=t.currentTarget,i=!1,o=[],s=n=1,r=this.game[this.scene-1].positions.length;r>=n;s=n+=1)e=this.library["hsc"+s].globalToLocal(this.stage.mouseX,this.stage.mouseY),this.library["hsc"+s].hitTest(e.x,e.y)?this.answer.index===this.library["hsc"+s].index?(this.answer.p?1===(a=this.library["sc"+s].currentFrame)||2===a?this.library["sc"+s].gotoAndStop(3):"p1"===this.answer.p?this.library["sc"+s].gotoAndStop(1):this.library["sc"+s].gotoAndStop(2):this.library["sc"+s].gotoAndStop(1),this.answer.visible=!1,createjs.Sound.play("good"),0===this.intento&&this.library.score.plusOne(),this.intento=0,o.push(this.finishEvaluation())):(this.intento=1,this.warning(),o.push(this.answer.returnToPlace())):o.push(this.answer.returnToPlace());return o},s.prototype.finishEvaluation=function(){var t,i,s;for(t=i=1,s=this.game[this.scene-1].positions.length;s>=i;t=i+=1)if(this.library["sc"+t].currentFrame!==this.library["sc"+t].spriteSheet._frames.length-1)return;return this.finish()},s.prototype.finish=function(){return createjs.Sound.stop(),createjs.Sound.play("good"),TweenLite.to(this.library.cuento,1,{alpha:0,y:this.library.cuento.y+10}),TweenLite.to(this.library.bg,1,{alpha:0}),s.__super__.finish.apply(this,arguments)},window.U3A5=s,s}(Oda)}).call(this);